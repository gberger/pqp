<div class="panel panel-primary chat" id="chat">
  <div class="panel-heading">Chat de <%= course.abbreviation %></div>
  <ul class="list-group chat-messages">
    <li class="list-group-item no-messages-placeholder">Carregando...</li>
  </ul>
  <div class="panel-footer">
    <% if current_user %>
    <form class="chat-form">
      <div class="input-group">
        <input type="text" class="form-control chat-msg-input" maxlength="512">
        <span class="input-group-btn">
          <input type="submit" class="btn btn-success" value="»"/>
        </span>
      </div>
    </form>
    <% else %>
      Faça <a href="/auth/facebook" id="sing_in">login com Facebook <i class="fa fa-facebook-square"></i></a> para participar do chat!
    <% end %>
  </div>
</div>

<% content_for :bottom do %>
  <script>
    <% if current_user %>
      var isAdmin = <%= current_user.is_admin? %>;
      var oauth_token = '<%= j current_user.oauth_token %>';
    <% end %>
    var course = '<%= j course.abbreviation %>';
    var recentMessages = <%= raw recent_messages.to_json %>;

    var chat = new Chat(element, url, course, template)

    var message, i;
    for (i = recentMessages.length - 1; i >= 0; i -= 1) {
      window.chat.messageReceiveHandler(recentMessages[i]);
    }

  </script>
<% end %>